{% extends "layout.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='learn.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='slider.css') }}">
<script src="{{ url_for('static', filename='js/learn.js') }}"></script>
{% endblock %}

{% block content %}
<div class="learn-page">

    <!-- Add background here later -->
    <div class="learn-top"></div>

    {% if step.slider_options %}
    <div class="slider-wrapper">
        <div class="vertical-slider-container">
            <div class="scale">
                {% for label in step.slider_options | reverse %}
                <div class="tick">
                    <span>{{ label }} oz</span>
                    <div class="line"></div>
                </div>
                {% endfor %}
            </div>
            <input
            type="range"
            class="oz-slider"
            id="oz-slider-learn"
            min="0"
            max="{{ step.slider_options|length - 1 }}"
            step="1"
            value="0"
            data-options='{{ step.slider_options | tojson }}'
            data-correct="{{ step.slider_correct_idx }}">
        </div>
        <button type="button" id="pour-button-learn" class="next-btn mt-3">POUR</button>
    </div>
    {% endif %}

    <!-- Chatbox (Lesson 1-2) -->
    <div class="chat">
    {% if step.text %}
        <div class="learn-text">
          {{ step.text | highlight_text(step.highlight) }}
        </div>
    {% endif %}
    </div>

    <!-- Lesson 2: Notebook and Squirrel -->
    {% if step.notebook %}
    <div class="notebook-box">
    <div class="notebook-title"><strong>Customer's Order:</strong></div>
    <ul class="notebook-list">
        {% for item in step.notebook %}
            {% if loop.index0 in step.strikethrough %}
                <li><s>{{ item }}</s></li>
            {% else %}
                <li>{{ item }}</li>
            {% endif %}
        {% endfor %}
    </ul>
    </div>
    {% endif %}

    {% if step.squirrel %}
    <div class="squirrel-helper">
    <img src="{{ url_for('static', filename='images/squirrel.png') }}" alt="squirrel" class="squirrel-icon">
    <div class="squirrel-bubble">
        {{ step.squirrel }}
    </div>
    </div>
    {% endif %}

    <!-- The bottom green section, used for all -->
  <div class="learn-bottom">
    <div class="row no-gutters">
      <div class="col-10 learn-left p-4 d-flex flex-column justify-content-start">
        <div class="learn-lesson-header">
          Lesson {{ id }}: {{ lesson_name }}
        </div>
        <div class="learn-step-subheader">
          Step {{ step_num }} of {{ total_steps }}
        </div>

        {% if step["base-text"] %}
          <div class="learn-base-text">
            {% if step["base-text"] is iterable and (step["base-text"] is not string) %}
                {% for text_part in step["base-text"] %}
                <div>{{ text_part | highlight_text(step.highlight) }}</div>
                {% endfor %}
            {% else %}
              <div>{{ step["base-text"] }}</div>
            {% endif %}
          </div>
        {% endif %}
      </div>

      <!-- Buttons -->
      <div class="col-2 learn-right d-flex flex-column justify-content-center align-items-center">
        {% if next_step_url %}
            <a href="{{ next_step_url }}" id="continue-button" class="learn-button nav-link" data-url="{{ next_step_url }}">
                {% if is_last_step %}
                TAKE QUIZ
                {% else %}
                CONTINUE
                {% endif %}
            </a>
        {% endif %}
        {% if prev_step_url %}
          <a href="{{ prev_step_url }}" class="back-button nav-link" data-url="{{ prev_step_url }}">BACK</a>
        {% endif %}
      </div>

    </div>
  </div>
</div>
{% endblock %}
